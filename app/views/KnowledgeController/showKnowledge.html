#{extends 'main.html' /}
#{set title:messages.get('title.knowledge.show') /}

<fieldset>
    <legend>&{'title.knowledge.show'}</legend>

    <div class="knowledge span7 offset1">
        <div class="knowledge-title">${knowledge.title}</div>
        <div class="knowledge-info">&{'knowledge.info', knowledge.user.login, knowledge.createdDate.format()}</div>

        <div class="knowledge-description well">${knowledge.description.raw()}</div>

        <div class="control-group">
            <div class="controls">
                #{if session.get('user.id') && knowledge.user.id == Long.parseLong(session.get('user.id'))}
                    <a class="btn btn-primary" href="@{KnowledgeController.editKnowledge(knowledge.id)}">&{'button.edit'}</a>
                #{/if}
                #{backButton /}
            </div>
        </div>

        <div class="knowledge-comments">
            #{list items:comments, as:'comment'}
                <div class="knowledge-comment">
                    <div class="knowledge-comment-info">&{'knowledge.comment.info', comment.user.login, comment.createdDate.format()}</div>
                    <div class="knowledge-comment-content">
                        <pre>${comment.content}</pre>
                    </div>
                </div>
            #{/list}
        </div>

        #{if session.get('user.id')}
            <div>
                <form action="@{KnowledgeController.saveComment()}" method="POST">
                    <input name="knowledgeId" type="hidden" value="${knowledge.id}">
                    <input name="userId" type="hidden" value="${session.get('user.id')}">

                    <textarea class="span7" name="content" placeholder="&{'knowledge.comment'}"></textarea>

                    <div class="control-group">
                        <div class="controls">
                            <button class="btn btn-primary" type="submit">&{'button.comment.add'}</button>
                        </div>
                    </div>
                </form>
            </div>
        #{/if}
    </div>
</fieldset>